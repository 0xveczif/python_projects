#!/usr/bin/python

import scanner

#insert url to crawl -
#target_url = "http://testfire.net/feedback.jsp"
#target_url = "http://testfire.net/"
target_url = "http://testfire.net/index.jsp?content=personal_investments.htm"
links_to_ignore = ["http://testfire.net/logout.jsp"]               #logout link as if this gets executed, session will be over
data_dict = {"username": "admin", "password": "admin", "Login":"submit"}

try:
    #insert url to login - login page and insert in data dict - correct field names and type of login buttin
    vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
    vuln_scanner.session.post("http://testfire.net/login.jsp", data=data_dict)
    #vuln_scanner.session.post("http://testfire.net/index.jsp?content=personal_investments.htm", data=data_dict)
    #vuln_scanner.session.post("http://testfire.net/", data=data_dict)
    #vuln_scanner.session.post("http://testfire.net/feedback.jsp", data=data_dict)

    vuln_scanner.crawl()
    vuln_scanner.run_scanner()
except KeyboardInterrupt:
    print("\n[-] Detected Ctrl+C ... Exiting from program...")
    exit()





